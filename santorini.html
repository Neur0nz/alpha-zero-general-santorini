<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/fomantic-ui@2.9.3/dist/semantic.min.css">
  <script src="https://cdn.jsdelivr.net/pyodide/v0.26.1/full/pyodide.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/onnxruntime-web@1.16.0/dist/ort.min.js"></script>
  <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
  
  <script src="./santorini/constants_nogod.js"></script>
  <script src="./common/game.js"></script>
  <script src="./santorini/main.js"></script>
  <style>
    /* Enhanced Design System */
        :root {
          --primary-color: #2185d0;
          --primary-hover: #1678c2;
          --success-color: #21ba45;
          --warning-color: #fbbd08;
          --danger-color: #db2828;
          --text-color: #333;
          --text-muted: #666;
          --border-color: #e1e8ed;
          --background-light: #f8f9fa;
          --shadow: 0 2px 4px rgba(0,0,0,0.1);
          --shadow-hover: 0 4px 8px rgba(0,0,0,0.15);
          --border-radius: 8px;
          --transition: all 0.2s ease;
          
          /* Enhanced design system */
          --font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          --font-size-xs: 0.75rem;
          --font-size-sm: 0.875rem;
          --font-size-base: 1rem;
          --font-size-lg: 1.125rem;
          --font-size-xl: 1.25rem;
          --spacing-xs: 0.25rem;
          --spacing-sm: 0.5rem;
          --spacing-md: 1rem;
          --spacing-lg: 1.5rem;
          --spacing-xl: 2rem;
        }

        /* Enhanced Typography */
        body {
          font-family: var(--font-family);
          font-size: var(--font-size-base);
          line-height: 1.6;
          color: var(--text-color);
        }

        /* Improved Button Hierarchy */
        .ui.button.primary {
          font-weight: 600;
          letter-spacing: 0.025em;
          text-transform: none;
        }

        .ui.button.secondary {
          font-weight: 500;
          opacity: 0.9;
        }

        /* Enhanced Card Design */
        .ui.card {
          border: 1px solid var(--border-color);
          box-shadow: var(--shadow);
          transition: var(--transition);
        }

        .ui.card:hover {
          box-shadow: var(--shadow-hover);
          transform: translateY(-1px);
        }

        /* Improved Form Elements */
        .ui.dropdown {
          font-weight: 500;
        }

        .ui.dropdown .menu {
          border-radius: var(--border-radius);
          box-shadow: var(--shadow-hover);
        }

        /* Better Visual Feedback */
        .ui.button:active {
          transform: translateY(1px);
        }

        .ui.button.loading {
          position: relative;
          overflow: hidden;
        }

        /* Enhanced Progress Bars */
        .ui.progress .bar {
          background: linear-gradient(90deg, var(--primary-color), var(--success-color));
          border-radius: var(--border-radius);
        }

        /* Improved Accessibility */
        .ui.button:focus,
        .ui.dropdown:focus {
          outline: 2px solid var(--primary-color);
          outline-offset: 2px;
        }

        /* Better Mobile Experience */
        @media (max-width: 768px) {
          .ui.button {
            min-height: 44px; /* Touch-friendly */
          }
          
          .ui.dropdown {
            min-height: 44px;
          }
        }

        /* Enhanced Game Board Visual Feedback */
        .ui.table tbody tr td.selectable:hover {
          background-color: #e3f2fd !important;
          transform: scale(1.02);
          box-shadow: inset 0 0 0 2px var(--primary-color);
        }

        .ui.table tbody tr td.selectable.selected {
          background-color: #bbdefb !important;
          box-shadow: inset 0 0 0 3px var(--primary-color);
        }

        /* Improved Evaluation Bar */
        .eval-bar-box {
          position: relative;
          overflow: hidden;
        }

        .eval-bar-box::before {
          content: '';
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          background: linear-gradient(90deg, 
            rgba(219, 40, 40, 0.1) 0%, 
            rgba(255, 255, 255, 0.1) 50%, 
            rgba(33, 186, 69, 0.1) 100%);
          pointer-events: none;
        }

        /* Enhanced Loading States */
        .ui.button.loading::after {
          content: '';
          position: absolute;
          top: 0;
          left: -100%;
          width: 100%;
          height: 100%;
          background: linear-gradient(90deg, 
            transparent, 
            rgba(255, 255, 255, 0.4), 
            transparent);
          animation: loading-shimmer 1.5s infinite;
        }

        @keyframes loading-shimmer {
          0% { left: -100%; }
          100% { left: 100%; }
        }

        /* Improved Accordion Design */
        .ui.accordion .title {
          font-weight: 600;
          transition: var(--transition);
        }

        .ui.accordion .title:hover {
          background-color: var(--background-light);
        }

        .ui.accordion .title.active {
          background-color: var(--primary-color);
          color: white;
        }

        /* Enhanced Modal Design */
        .ui.modal {
          border-radius: var(--border-radius);
          box-shadow: 0 20px 40px rgba(0, 0, 0, 0.2);
        }

        .ui.modal .header {
          font-weight: 600;
          border-bottom: 1px solid var(--border-color);
        }

        /* Better List Items */
        .ui.list .item {
          transition: var(--transition);
        }

        .ui.list .item:hover {
          background-color: var(--background-light);
          transform: translateX(4px);
        }


    /* Game Board Enhancements */
    .ui.table tbody tr td.selectable {
      background-color: #f3f8ff;
      transition: var(--transition);
    }

    .ui.table tbody tr td.selectable:hover {
      background-color: #e8f1ff;
      transform: scale(1.02);
      box-shadow: var(--shadow);
    }

    /* Enhanced Button Styles */
    .ui.button {
      border-radius: var(--border-radius);
      transition: var(--transition);
      font-weight: 500;
    }

    .ui.button:hover {
      transform: translateY(-1px);
      box-shadow: var(--shadow-hover);
    }

    .ui.button.primary {
      background: linear-gradient(135deg, var(--primary-color), var(--primary-hover));
      border: none;
    }

    /* Card Components */
    .ui.card {
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      transition: var(--transition);
    }

    .ui.card:hover {
      box-shadow: var(--shadow-hover);
    }

    /* Accordion Enhancements */
    .ui.accordion .title {
      background: var(--background-light);
      border-radius: var(--border-radius);
      transition: var(--transition);
    }

    .ui.accordion .title:hover {
      background: #e8f1ff;
    }

    /* Progress Bar Enhancements */
    .ui.progress .bar {
      background: linear-gradient(90deg, var(--primary-color), var(--success-color));
      border-radius: var(--border-radius);
    }

    /* Loading States */
    .loading-spinner {
      display: inline-block;
      width: 16px;
      height: 16px;
      border: 2px solid #f3f3f3;
      border-top: 2px solid var(--primary-color);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* Responsive Layout */
    .game-container {
      display: flex;
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
      padding: 20px;
    }

    .board-section {
      flex: 0 0 auto;
    }

    .eval-section {
      flex: 1;
      min-width: 400px;
    }

    /* Mobile Layout */
    @media (max-width: 1024px) {
      .game-container {
        flex-direction: column;
        padding: 10px;
      }
      
      .eval-section {
        min-width: unset;
        order: 2;
      }
      
      .board-section {
        order: 1;
      }
    }

    /* Responsive Design */
    @media (max-width: 768px) {
      .ui.container {
        padding: 0 1rem;
      }
      
      .ui.menu .item {
        padding: 0.5rem;
      }

      .game-container {
        padding: 5px;
        gap: 10px;
      }

      .ui.menu {
        flex-wrap: wrap;
      }

      .ui.menu .fitted.item {
        margin-right: 8px !important;
      }
    }

    /* Header Improvements */
    .ui.menu {
      display: flex;
      flex-wrap: nowrap;
      align-items: center;
      padding: 0.5rem 0;
    }

    .ui.menu .fitted.item {
      margin-right: 12px;
      white-space: nowrap;
    }

    .ui.menu .fitted.item:last-child {
      margin-right: 0;
    }

    /* Mobile Text Hiding */
    .hide-on-mobile {
      display: inline;
    }

    @media (max-width: 768px) {
      .hide-on-mobile {
        display: none;
      }
    }

    /* Graph Responsiveness */
    @media (max-width: 1024px) {
      .eval-section svg {
        width: 100%;
        height: auto;
      }
    }

    /* Focus States for Accessibility */
    .ui.button:focus,
    .ui.accordion .title:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }
  </style>
</head>
</head>
<body>

<div class="ui borderless menu">
  <div class="ui container">    
    <div class="fitted item" style="margin-right: 10px;">
      <button class="ui icon button" onclick="reset()" title="New game"><i class="file outline icon"></i></button>
    </div>
    <div class="fitted item" style="margin-right: 14px;">
      <button class="ui primary button" onclick="start_guided_setup()" title="Guided setup: place pieces then start">
        <i class="play icon"></i> Setup
      </button>
    </div> 
    <div class="fitted item" x-data="{ editMode: 0 }" style="margin-right: 14px;">
      <div class="ui compact small buttons" style="display: inline-flex;">
        <button 
          class="ui button" 
          :class="{ 'active primary': editMode === 0 }"
          @click="editMode = 0; setEditMode(0)"
          title="Normal play mode">
          <i class="play icon"></i>
        </button>
        <button 
          class="ui button secondary" 
          :class="{ 'active': editMode === 1 }"
          @click="editMode = 1; setEditMode(1)"
          title="Edit building levels">
          <i class="building icon"></i>
        </button>
        <button 
          class="ui button red" 
          :class="{ 'active': editMode === 2 }"
          @click="editMode = 2; setEditMode(2)"
          title="Edit worker positions">
          <i class="chess icon"></i>
        </button>
      </div>
    </div> 
    <div class="fitted item"> 
      <div class="ui small form">
        <div class="field">
          <select onchange="game.change_difficulty(this.value)" id="difficultyForm">
            <optgroup label="Above optimal">
            <option value="12800"       >God-like</option>
            <option value="3200"       >Boosted</option>
            <optgroup label="Level used during training">
            <option value="800"        >Native</option>
            <optgroup label="Sub optimal levels">
            <option value="200"        >Medium</option>
            <option value="50" selected>Easy</option>
            <option value="12"         >Easier</option>
            <option value="3"          >Come on</option>
          </select>
        </div>
      </div>
    </div>
    <div class="fitted item" style="margin-right: 14px;">
      <button class="ui icon button" onclick="showHistoryModal()" title="View game history">
        <i class="history icon"></i>
      </button>
    </div>
    <div class="fitted item"> 
      <div class="ui small form">
        <div class="field">
          <select onchange="changeGameMode(this.value)">
            <option value="P0" selected>You vs AI</option>
            <option value="P1"         >AI vs you</option>
            <option value="Human"      >No AI</option>
            <option value="AI"         >WarGames</option>
          </select>
        </div>
      </div>
    </div>
  </div>
</div>


<!-- Responsive Game Layout -->
<div class="game-container">
  <!-- Board Section -->
  <div class="board-section">
<div class="ui main container">
      <!-- Players info -->
      <div class="ui horizontal basic segments" style="display: none;">
    <div class="ui center aligned vertically fitted segment">
      <span class="ui large green text" id="p0title">You</span>
          <p id="p0details"></p>
    </div>
    <div class="ui center aligned vertically fitted segment">
      <span class="ui large red text" id="p1title">AI</span>
          <p id="p1details"></p>
        </div>
      </div>


  <!-- Table -->

  
  <table class="ui fixed unstackable celled huge compact table"><tbody>
    <tr class="center aligned">
      <td class="" id="cell_0_0"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_0_1"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_0_2"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_0_3"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_0_4"><div class="ui middle aligned tiny image"></div></td>
    </tr>
    <tr class="center aligned">
      <td class="" id="cell_1_0"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_1_1"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_1_2"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_1_3"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_1_4"><div class="ui middle aligned tiny image"></div></td>
    </tr>
    <tr class="center aligned">
      <td class="" id="cell_2_0"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_2_1"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_2_2"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_2_3"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_2_4"><div class="ui middle aligned tiny image"></div></td>
    </tr>
    <tr class="center aligned">
      <td class="" id="cell_3_0"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_3_1"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_3_2"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_3_3"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_3_4"><div class="ui middle aligned tiny image"></div></td>
    </tr>
    <tr class="center aligned">
      <td class="" id="cell_4_0"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_4_1"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_4_2"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_4_3"><div class="ui middle aligned tiny image"></div></td>
      <td class="" id="cell_4_4"><div class="ui middle aligned tiny image"></div></td>
    </tr>
  </tbody></table>


<!-- Button -->


  <div class="ui fluid large compact buttons" id="allBtn" style="display: none">
    <button class="ui icon button" id="undoBtn" onclick="cancel_and_undo()" title="Step back"><i class="undo icon"></i></button>
    <button class="ui icon button" id="redoBtn" onclick="redo_last()" title="Step forward"><i class="redo icon"></i></button>
  </div>
  <button class="ui fluid large active loading button" id="loadingBtn" style="display: none;">
    <i class="spinner loading icon"></i>
    AI thinking...
  </button>
  <div class="ui hidden info message" id="editMsg">
    <div class="header">Info for editing</div>
    <p>Tap on cells to change their heights, then tap again on edit button and tap on cells to toggle worker. Finally tap edit button to validate</p>
  </div>

  <div class="ui basic segment">
    <p id="moveSgmt">Loading pyodide, numpy, onnx; please wait...</p>
  </div>
</div>
  </div>

  <!-- Evaluation Section -->
  <div class="eval-section">
    <!-- Enhanced Evaluation Display -->
    <div id="evalContainer" x-data="evalBarData()" x-init="init(); window.evalBar = $el">
      <div class="ui card" style="margin-top: 10px; border-radius: var(--border-radius); box-shadow: var(--shadow);">
        <!-- Enhanced Header -->
        <div class="content" style="background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%); border-radius: var(--border-radius) var(--border-radius) 0 0;">
          <div class="header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
            <div style="flex: 1;">
              <button 
                class="ui mini compact basic button" 
                @click="toggleCollapse()" 
                title="Hide/Show evaluation"
                style="border-radius: var(--border-radius);">
                <i :class="collapsed ? 'chevron down' : 'chevron up'" class="icon"></i>
              </button>
            </div>
            <div style="text-align: center; font-weight: 600; font-size: 14px; color: var(--text-color);">
              <i class="robot icon"></i> AI EVALUATION
            </div>
            <div style="flex: 1; text-align: right;">
              <div class="ui mini icon buttons">
                <button 
                  class="ui primary button" 
                  @click="recalculate()" 
                  :class="{ 'loading': calculating }"
                  :disabled="calculating"
                  title="Recalculate evaluation for current position"
                  style="border-radius: var(--border-radius);">
                  <i class="refresh icon"></i>
                </button>
              </div>
            </div>
          </div>
        
        <!-- Collapsible content -->
        <div x-show="!collapsed" x-transition>
          <!-- Labels -->
          <div style="display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 4px; padding: 0 20px; color: #666;">
            <span style="color: #DB2828;">← Red (Player 1)</span>
            <span style="color: #21BA45;">Green (Player 0) →</span>
          </div>
          
          <!-- Evaluation Bar -->
          <div x-ref="evalBox" class="eval-bar-box" style="position: relative; max-width: 400px; width: 100%; height: 24px; border: 2px solid #333; border-radius: 4px; margin: 8px auto; background: #f0f0f0;">
            <!-- Center line marker -->
            <div style="position: absolute; left: 50%; top: 0; width: 2px; height: 100%; background: #666; transform: translateX(-1px);"></div>
            
            <!-- Colored bar expanding from center -->
            <template x-if="value > 0">
              <div 
                :style="`position: absolute; left: 50%; top: 0; width: ${barWidth}px; height: 100%; background: ${barColor}; transition: width 0.3s ease;`">
              </div>
            </template>
            <template x-if="value < 0">
              <div 
                :style="`position: absolute; right: 50%; top: 0; width: ${barWidth}px; height: 100%; background: ${barColor}; transition: width 0.3s ease;`">
              </div>
            </template>
          </div>
          
          <!-- Current Evaluation -->
          <div style="text-align: center; margin-bottom: 12px;">
            <span style="font-weight: bold; font-size: 16px;" x-text="evalText"></span>
            <span style="color: #666; margin-left: 8px;" x-text="'(' + advantage + ')'"></span>
          </div>
          
          
          <!-- Accordion for History and Top Moves -->
          <div class="ui styled fluid accordion" style="margin-top: 12px; border-radius: var(--border-radius);">
            <div class="title" 
                 :class="{active: showMoves && (topMoves && topMoves.length > 0)}" 
                 @click="showMoves=!showMoves"
                 style="border-radius: var(--border-radius); transition: var(--transition);">
              <i class="dropdown icon"></i>
              <span style="font-weight: 500;">Top Moves</span>
              <span class="ui tiny grey label" 
                    style="margin-left: 6px; border-radius: var(--border-radius);" 
                    x-text="(topMoves && topMoves.length) ? topMoves.length : 0"></span>
              <div class="ui mini buttons" style="margin-left: 8px;">
                <select class="ui mini compact selection dropdown" 
                        @click.stop 
                        @change="calcMovesDepth = ($event.target.value === 'ai') ? null : parseInt($event.target.value)" 
                        title="Override depth for options calc" 
                        style="padding: 2px 6px; border-radius: var(--border-radius);">
                  <option value="ai">Use AI setting</option>
                  <option value="50">Easy (50)</option>
                  <option value="200">Medium (200)</option>
                  <option value="800">Native (800)</option>
                  <option value="3200">Boosted (3200)</option>
                </select>
                <button class="ui mini primary button" 
                        :class="{loading: calcMovesLoading}" 
                        @click.stop="fetchTopMovesWithAdv()" 
                        title="Calculate options with advantage (costly)"
                        style="border-radius: var(--border-radius);">
                  <i class="bolt icon"></i>
                  <span x-show="!calcMovesLoading">Calc options</span>
                  <span x-show="calcMovesLoading">Calculating…</span>
                </button>
              </div>
            </div>
            <div class="content" :class="{active: showMoves && (topMoves && topMoves.length > 0)}">
              <div class="ui very compact small relaxed list" style="max-width: 540px; margin: 0 auto;">
                <template x-for="m in (topMoves || [])" :key="m.action">
                  <div class="item" 
                       style="display:flex; align-items:center; gap:10px; padding: 8px; border-radius: var(--border-radius); transition: var(--transition);"
                       :style="'background: ' + (m.eval !== undefined ? (m.eval >= 0 ? '#f0f9ff' : '#fef2f2') : '#f8f9fa') + ';'">
                    <div class="content" style="flex:1;">
                      <div class="header" 
                           style="font-weight: 500; color: var(--text-color);" 
                           x-text="m.text"></div>
                      <div class="description" style="margin-top: 4px;">
                        <template x-if="m.eval !== undefined">
                          <span>
                            <span class="ui tiny label" 
                                  :class="m.eval >= 0 ? 'green' : 'red'" 
                                  style="border-radius: var(--border-radius);"
                                  x-text="(m.eval >= 0 ? '+' : '') + Number(m.eval).toFixed(2)"></span>
                            <span class="ui tiny basic label" 
                                  x-show="m.delta !== undefined && Math.abs(m.delta) >= 0.005" 
                                  :class="m.delta >= 0 ? 'green' : 'red'" 
                                  style="border-radius: var(--border-radius);"
                                  x-text="'Δ ' + ((m.delta >= 0 ? '+' : '') + Number(m.delta).toFixed(2))"></span>
                          </span>
                        </template>
                        <span x-show="m.eval === undefined">
                          <span class="ui tiny grey label" 
                                style="border-radius: var(--border-radius);"
                                x-text="Math.round(m.prob*100) + '%'" 
                                title="policy probability"></span>
                        </span>
                      </div>
                    </div>
                    <div class="extra" style="flex:0 0 auto; min-width: 120px; text-align:right; padding: 4px 8px;">
                      <div class="ui tiny indicating progress" 
                           :data-percent="Math.round(m.prob*100)"
                           style="border-radius: var(--border-radius); height: 6px; background: #e0e0e0;">
                        <div class="bar" 
                             :style="`width: ${Math.round(m.prob*100)}%; border-radius: var(--border-radius); background: linear-gradient(90deg, var(--primary-color), var(--success-color));`"></div>
                      </div>
                      <div style="font-size: 10px; color: #666; margin-top: 2px;" x-text="Math.round(m.prob*100) + '%'"></div>
                    </div>
                  </div>
                </template>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- History Modal -->
<div class="ui modal" id="historyModal" x-data="historyModal()">
  <div class="header">
    <i class="history icon"></i>
    Game History
  </div>
  <div class="content">
    <div class="ui relaxed divided list">
      <template x-for="(move, index) in gameMoves" :key="index">
        <div class="item" 
             :class="{ 'active': index === currentMove }"
             @click="jumpToMove(index)"
             style="cursor: pointer; padding: 12px; border-radius: var(--border-radius); transition: var(--transition);"
             :style="index === currentMove ? 'background: var(--primary-color); color: white;' : 'background: var(--background-light);'">
          <div class="content">
            <div class="header" style="font-weight: 500;">
              <span x-text="move.description"></span>
              <span x-show="index === currentMove" style="margin-left: 8px; font-size: 12px; opacity: 0.8;">(Current)</span>
            </div>
            <div class="description" style="margin-top: 4px; font-size: 14px;">
              Player <span x-text="move.player"></span> move
            </div>
            <div class="meta" style="margin-top: 4px; font-size: 12px; opacity: 0.7;">
              Eval: <span x-text="move.evaluation ? move.evaluation.toFixed(3) : 'N/A'"></span>
            </div>
          </div>
        </div>
      </template>
    </div>
  </div>
  <div class="actions">
    <div class="ui button" @click="closeModal()">Close</div>
    <div class="ui primary button" @click="jumpToMove(0)">Go to Start</div>
    <div class="ui primary button" @click="jumpToMove(gameMoves.length - 1)">Go to End</div>
  </div>
</div>

<script>
  const allBtn      = document.getElementById('allBtn');
  const undoBtn     = document.getElementById('undoBtn');
  const loadingBtn  = document.getElementById('loadingBtn');
  const editBtn     = document.getElementById('editBtn');
  const moveSgmt    = document.getElementById('moveSgmt');
  const p0title     = document.getElementById('p0title');
  const p0details   = document.getElementById('p0details');
  const p1title     = document.getElementById('p1title');
  const p1details   = document.getElementById('p1details');
  const editMsg     = document.getElementById('editMsg');

  const counterAPI_base = 'https://abacus.jasoncameron.dev/hit/cestpasphoto.github.io';
  const counterAPI_suffix = new Date().toISOString().slice(2,7).replace('-','');
  window.onload = () =>
    [ `${counterAPI_base}/overall`, `${counterAPI_base}/overall_${counterAPI_suffix}`,`${counterAPI_base}/santorini_${counterAPI_suffix}`]
    .forEach(u => fetch(u).catch(() => {}));

  main(usePyodide=true);
</script>
<script>

</script>
</body>
</html>
